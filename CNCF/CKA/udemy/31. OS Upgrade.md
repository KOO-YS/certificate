# OS Upgrade

- 유지보수를 목적으로 클러스터 일부 노드를 제거해야 하는 상황
    - 소프트웨어 기반 업그레이드, 패치 적용, 보안 패치
    

- 만약 하나의 Node가 작동을 중지하면, 그 안에 있는 Pod들에 접근이 할 수 없다
    - 타 Node에 같은 애플리케이션을 배치했다면 자동으로 리다이렉션이 되지만,
    - 해당 Node에만 존재하는 유일한 애플리케이션 Pod라면, 앱 사용자들은 영향을 받을 수 밖에 없다

1. Node가 즉각적으로 재실행되는 경우
    - kubelet이 실행되고 pod가 재운영된다
2. Node가 5분 이상 중지된 경우
    - pod는 해당 노드에서 종료된다
    - Kubernetes는 pod가 죽은것으로 판정하고 replicaSet 정보에 따라 다른 node에 pod를 재배치한다
    - pod-eviction-time : pod가 다시 재기동되는 시간 (controller manager에서 관리. default : 5분) 
    - pod-eviction-time 이 모두 지난 다음 재기동된 Node는 그대로 빈 상태로 유지된다


노드에서 실행되고 있는 Pod들이 ReplicaSet을 가지고 있고, 단기간 중단되도 괜찮다는 전제하에 
Node 유지보수 작업을 진행할 수 있다 
-> 하지만 이 Node가 5분 안에 재기동된다고 장담할 수 없기에 더 안전한 방법을 고안해야 한다 