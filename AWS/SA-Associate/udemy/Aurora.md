# Aurora

- AWS의 독점 기술
- 오픈소스가 아니지만 MySQL, PostgreSQL과 호환된다
    - 두 DB들과 Aurora의 호환 드라이버가 있다
- 클라우드에 최적화되어 잇으며 고성능
    - MySQL의 5배
    - PostgreSQL의 3배
- 스토리지는 자동으로 커진다
    - 10GB로 시작해서 최대 128TB까지 자동으로 커진다
    - 직접 디스크를 모니터링 하지 않더라도 시간에 따라 자동으로 커진다
- 15개의 읽기 전용 레플리카를 가지며 (MySQL은 5개) 복제 속도가 훨씬 빠르다
- 장애 조치가 빠르다
- 비용이 RDS보다 20% 더 높지만 효율면에서 규모가 클 경우 절약 가능

<br>

## Aurora High Availability and Read Scaling

고가용성 및 읽기 스케일링

- 쓰기 요청을 할 때마다 6개의 데이터 복제본을 3개의 가용영역에 저장
    - 쓰기 : 4/6개가 복제
    - 읽기 : 3/6개가 복제
    - 자가 복구 가능 → 어떤 데이터가 손상될 경우 p2p 복제
    - 수백 개의 볼륨에 의지
- Aurora 하나의 인스턴스에서만 쓰기 가능
- 마스터가 작동하지 않으면 30초 이내에 장애 조치 실행
- 마스터 + 15개 읽기 전용 복제를 가질 수 있다
- 리전 간 복제를 지원

<br>


### Aurora DB Cluster

주로 클라이언트가 있을 때, 인스턴스 끼리 공유 방법

- 마스터가 유일하게 쓰기 기능을 할 수 있기 때문에 Writer 엔트포인트를 제공받는다
    - Writer Endpoint(DNS 이름)는 항상 마스터를 가리킨다
    - 읽기 전용 복제는 오토 스케일링이 가능 (최대 15개)
    - **오토 스케일링 중에는 애플리케이션이 복제본의 위치/URL을 어떻게 찾을까?**
        - Reader EndPoint
            - Writer 엔트포인트와 기능이 동일
            - 로드 밸런싱 연결을 도움
            - 모든 읽기 전용 복제본에 자동 연결

<br>


### Aurora 특징

- 자동 장애 복구
- 백업과 복구
- 독립적이면서 안전
- 산업 규정 준수 (Industry compliance)
- 푸시 버튼식 스케일링
- 다운타임 없는 자동 패치
- 향상된 모니터링
- 정기 유지 보수 (Routine Maintenance)
- 백트랙 (백업을 이용해 어떤 시간이던 데이터를 복구)

<br>


### Aurora 보안

- 다른 RDS 처럼 KMS  사용
- 자동 백업, 스냅샷, 복제본 암호화
- SSL을 통해 전송 중 암호화
- RDS 같이 IAM 사용
- 전부 RDS 보안과 동일하다


---

<br>


### Aurora Replicas - Auto Scaling

- 리더 엔드포인트에서 너무 많은 요청이 있어서 aurora DB의 cpu 사용량이 증가할 때, 오토 스케일링 복제본을 설정할 수 있다
- 새 복제본이 추가되어 트래픽을 수신하기 시작하고 전체 CPU 사용량을 낮추기 위해 좀 더 분산된 방식으로 읽기를 수행

<br>


### Aurora - Custom Endpoints

- 읽기 전용 복제본 중에서 더 큰 용량의 인스턴스의 서브셋을 사용자 지정 앤드 포인트로 정의 → 특정 복제본에 대한 분석 쿼리를 더 효율적으로 실행
- 사용자 지정 앤드 포인트를 갖게 된 후, 리더를 보통 사용하지 않는다.
- 실무에서는 다양한 워크로드에 대한 많은 사용자 지정 앤드 포인트를 설정하여 오로라 복제본의 하위 집합만을 쿼리할 수 있다.

<br>


### Aurora Serverless

- 자동화된 데이터베이스 인스턴스화
- 실제 사용을 기반으로 한 오토 스케일링
- 드물거나 간헐적, 예측 불가능한 워크로드가 있을 때 유용
    - 용량 계획을 수립할 필요가 없다
- 각 오로라 인스턴스의 초당 비용을 지불
- 클라이언트 : 오로라에서 관리하는 프록시 플릿(Proxy Fleet)과 통신
- 백엔드 : 서버리스 방식으로 워크로드 기반 많은 오로라 인스턴스가 생성 (용량 프로비저닝이 필요 없음)

<br>


### Aurora Multi Master

- 라이터 노드에 대한 즉각적인 장애 조치를 원하는 경우 → 높은 가용성을 원하는 경우
- 오로라 클러스터에 있는 모든 노드가 읽기/쓰기 작업
    - 쓰기 노드가 하나만 있고 다운되어 실패하면, 읽기 복제본을 새로운 마스터로 승격
    

<br>


### Global Aurora

- 오로라 리전 간 읽기 전용 복제본이 있다면?
    - 재해 복구에 유용
    - 구현 간단
- 글로벌 오로라
    - 모든 읽기 및 쓰기를 위한 주 리전 1개
    - 최대 5개의 보조 **읽기 전용 리전**, 최대 16개의 **복제본** 설정 가능, 보조 리전 당 복제본 랙이 1초 미만